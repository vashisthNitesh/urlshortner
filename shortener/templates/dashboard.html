{% extends "base.html" %}

{% block title %}PulseLink | Dashboard{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <div class="section-header">
      <div>
        <p class="eyebrow">Workspace</p>
        <h1>Dashboard</h1>
        <p class="muted">Create and manage short links. Active plan: <strong>{{ plan }}</strong>.</p>
      </div>
      <div class="plan-switcher">
        <a class="btn{% if not is_premium %} btn-primary{% endif %}" href="{% url 'dashboard' %}?plan=normal">Normal user</a>
        <a class="btn{% if is_premium %} btn-primary{% endif %}" href="{% url 'dashboard' %}?plan=premium">Premium user</a>
      </div>
    </div>
    <div class="grid-two">
      <div class="card">
        <h2>New link</h2>
        {% if success_slug %}
        <div class="notice success">Link created! Share /r/{{ success_slug }}.</div>
        {% endif %}
        <form method="post">
          {% csrf_token %}
          {{ form.non_field_errors }}
          <input type="hidden" name="plan" value="{{ plan|lower }}" />
          <label for="id_url">Destination URL</label>
          {{ form.url }}
          <label for="id_slug">Custom slug</label>
          {{ form.slug }}
          <label for="id_title">Title (optional)</label>
          {{ form.title }}
          <button class="btn-primary" type="submit">Create link</button>
        </form>
        <div class="notice">
          <h3>Plan features</h3>
          <ul class="feature-list">
            <li>Normal users access core shortening and analytics.</li>
            <li>Premium users unlock branded domains, QR codes, and exportable reports.</li>
            <li>Upgrade anytime via Razorpay checkout.</li>
          </ul>
          <a class="btn-secondary" href="{% url 'pricing' %}">Review plan details</a>
        </div>
      </div>
      <div class="card">
        <h2>Recent links</h2>
        <ul class="link-list">
          {% for link in links %}
          <li>
            <div>
              <strong>{{ link.title|default:link.slug }}</strong>
              <span>/r/{{ link.slug }}</span>
            </div>
            <a class="btn" href="{% url 'redirect' slug=link.slug %}" target="_blank">Open</a>
          </li>
          {% empty %}
          <li class="muted">No links created yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% if not is_premium %}
    <div class="ad-card">
      <div>
        <p class="eyebrow">Google AdSense</p>
        <h3>Sponsored placement for normal users</h3>
        <p class="muted">
          Normal users see AdSense placements to keep PulseLink free. Upgrade to Premium to remove ads across the dashboard
          and redirect previews.
        </p>
      </div>
      <a class="btn-primary" href="{% url 'pricing' %}">Upgrade with Razorpay</a>
    </div>
    {% else %}
    <div class="notice success">
      <h3>Premium experience activated</h3>
      <p>No ads are displayed for premium users. Enjoy full analytics, custom domains, and priority support.</p>
    </div>
    {% endif %}
  </div>
</section>
{% endblock %}
